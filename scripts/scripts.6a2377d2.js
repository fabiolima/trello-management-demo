"use strict";function CardComponent(a){const b=this;b.formState={show:!1,loading:!1},b.cardForm={},b.$onInit=function(){b.card=JSON.parse(this.data),b.cardForm={name:b.card.name,due:new Date(b.card.badges.due)}},b.toggleForm=function(){b.formState.show=!b.formState.show},b.submit=function(){b.formState.loading=!0;const c=Object.assign(b.cardForm,{idList:b.listId});Trello.put("/cards/"+b.card.id,c).then(function(c){b.toggleForm(),b.card=c,b.formState.loading=!1,a.$apply()})},b["delete"]=function(a){const c=window.confirm("Are you shure you want delete this card?");c&&Trello.del("/cards/"+a).then(function(){b.refresh()})}}function CardsListComponent(a){const b=this;b.formState={show:!1,loading:!1},b.cardForm={name:null,due:new Date},b.$onInit=function(){b.getCards()},b.getCards=function(){Trello.lists.get(this.listId,{cards:"all"}).then(function(c){b.list=c,b.cards=c.cards,a.$apply()})},b.refresh=function(){b.getCards()},b.toggleForm=function(){b.formState.show=!b.formState.show},b.submit=function(c){b.formState.loading=!0;const d=Object.assign(b.cardForm,{idList:b.listId});Trello.post("/cards",d).then(function(d){b.toggleForm(),b.cards.push(d),b.resetForm(c),b.formState.loading=!1,a.$apply()})},b.resetForm=function(a){a.$setPristine(),b.cardForm={due:new Date}}}function TopbarComponent(a,b){const c=this;c.user=null,c.board=null,b.$on("user.authenticated",function(b,d){c.user=d,a.$apply()}),b.$on("board.selected",function(b,d){c.board=d,a.$apply()})}angular.module("trelloManagementApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider","$locationProvider",function(a,b){a.when("!#/",{controllerAs:"root",resolve:["$location",function(a){console.log("alo"),a.url("/#!/cusujjo")}]}).when("/login",{templateUrl:"views/login.html",controller:"LoginCtrl",controllerAs:"login"}).when("/boards",{templateUrl:"views/boards.html",controller:"BoardsCtrl",controllerAs:"boards",resolve:{authorize:["authFactory","$location",function(a,b){return a.authorized()?!0:void 0}]}}).when("/boards/:id",{templateUrl:"views/board-lists.html",controller:"BoardListsCtrl",controllerAs:"boards-lists",resolve:{authorize:["authFactory","$location",function(a,b){return a.authorized()?!0:void 0}]}}).otherwise("/login")}]).factory("authFactory",["$location",function(a){return{authorized:function(){return Trello.authorized()?!0:a.path("/login")}}}]),CardComponent.$inject=["$scope"],angular.module("trelloManagementApp").component("card",{templateUrl:"views/card.html",controller:CardComponent,bindings:{data:"@",refresh:"&refresh"}}),CardsListComponent.$inject=["$scope"],angular.module("trelloManagementApp").component("cardsList",{templateUrl:"views/cards-list.html",controller:CardsListComponent,bindings:{listId:"@",listName:"@"}}),TopbarComponent.$inject=["$scope","$rootScope"],angular.module("trelloManagementApp").component("topbar",{templateUrl:"views/topbar.html",controller:TopbarComponent}),angular.module("trelloManagementApp").controller("LoginCtrl",["$scope","$location","$rootScope",function(a,b,c){a.login=function(){Trello.authorize({type:"popup",name:"Trello Management Demo",scope:{read:"true",write:"true"},expiration:"never",success:this.authenticationSuccess,error:this.authenticationFailure})},a.authenticationSuccess=function(){Trello.members.get("me").then(function(d){c.$emit("user.authenticated",d),b.path("/boards"),a.$apply()})},a.authenticationFailure=function(){window.alert("Authentication failed.")}}]),angular.module("trelloManagementApp").controller("BoardsCtrl",["$scope","$location","$rootScope",function(a,b,c){this.$onInit=function(){Trello.members.get("/me/boards").then(function(b){a.boards=b,c.$emit("board.selected",null),a.$apply()})},a.go=function(a){b.url("/board/"+a)}}]),angular.module("trelloManagementApp").controller("BoardListsCtrl",["$scope","$location","$rootScope","$routeParams",function(a,b,c,d){this.$onInit=function(){Trello.boards.get(d.id,{lists:"all"}).then(function(b){c.$emit("board.selected",b),a.currentBoard=b,a.lists=b.lists,a.$apply()})}}]),angular.module("trelloManagementApp").run(["$templateCache",function(a){a.put("views/board-lists.html",'<section ng-controller="BoardListsCtrl" class="boards-page"> <ul class="lists"> <li class="list" ng-repeat="list in lists"> <cards-list list-id="{{ list.id }}" list-name="{{ list.name }}"></cards-list> </li> </ul> </section>'),a.put("views/boards.html",'<section ng-controller="BoardsCtrl" class="boards-page"> <h3 class="section-title">Boards</h3> <ul class="boards"> <li class="board" ng-repeat="board in boards"> <a ng-href="/#!/boards/{{board.id}}" class="title">{{ board.name }}</a> </li> </ul> </section>'),a.put("views/card.html",'<div class="trello-card"> <!-- FORM --> <form ng-if="$ctrl.formState.show" ng-submit="$ctrl.submit(cardForm)" name="cardForm" class="card-form"> <div class="form-group"> <label for="name">Name</label> <input ng-model="$ctrl.cardForm.name" type="text" class="form-control" id="name" placeholder="Insert a task to work on"> </div> <div class="form-group"> <label for="due">Due</label> <input ng-model="$ctrl.cardForm.due" type="date" class="date form-control" id="due" placeholder="Password"> </div> <button type="submit" class="btn btn-primary"><i ng-if="$ctrl.formState.loading" class="fas fa-spinner fa-spin"></i>Update</button> <button type="button" ng-click="$ctrl.toggleForm()" class="btn btn-default">Cancel</button> </form> <!-- END FORM --> <!-- CARD INFO --> <div class="info" ng-if="!$ctrl.formState.show"> <span ng-if="$ctrl.card.badges.due" class="due"> Due: {{ $ctrl.card.badges.due | date }} </span> <span class="name"> {{ $ctrl.card.name }} </span> <div class="labels"> <span ng-repeat="label in $ctrl.card.labels" class="label label-default" style="background-color: {{ label.color }}"> {{ label.name || \'\' }} </span> </div> </div> <!-- END CARD INFO --> <!-- CARD ACTIONS --> <div class="actions" ng-if="!$ctrl.formState.show"> <span class="action" ng-click="$ctrl.toggleForm()"> <i class="fa fa-edit"></i> </span> <span class="action"> <i class="fa fa-eye"></i> </span> <span class="action" ng-click="$ctrl.delete($ctrl.card.id)"> <i class="fa fa-trash"></i> </span> </div> <!-- END CARD ACTIONS --> </div>'),a.put("views/cards-list.html",'<div class="panel panel-primary"> <div class="panel-heading"> <span class="title">{{ $ctrl.listName }}</span> <span class="action"> <a href="" ng-click="$ctrl.toggleForm()" class="btn btn-link">Add card</a> </span> </div> <div class="panel-body"> <!-- CARD FORM --> <form name="cardForm" ng-submit="$ctrl.submit(cardForm)" ng-if="$ctrl.formState.show" class="card-form"> <div class="form-group"> <label for="name">Name</label> <input ng-model="$ctrl.cardForm.name" type="text" class="form-control" id="name" placeholder="Insert a task to work on"> </div> <div class="form-group"> <label for="due">Due</label> <input ng-model="$ctrl.cardForm.due" type="date" class="date form-control" id="due"> </div> <button type="submit" class="btn btn-primary"><i ng-if="$ctrl.formState.loading" class="fas fa-spinner fa-spin"></i>Submit</button> <button type="button" ng-click="$ctrl.toggleForm()" class="btn btn-default">Cancel</button> </form> <!-- END CARD FORM --> <!-- CARDS --> <card ng-repeat="card in $ctrl.cards" data="{{ card }}" refresh="$ctrl.refresh()"> <!-- END CARDS --> <span class="empty" ng-if="$ctrl.cards.length < 1"> This list is empty :( </span> </div> </div>'),a.put("views/login.html",'<section ng-controller="LoginCtrl" class="login vh-center"> <div> <h4>Please login at Trello to start this demo :)</h4> <div> <button ng-click="login()" class="mx-center btn btn-link">Login</button> </div> </div> </section>'),a.put("views/main.html",'<section class="login"> <button ng-click="login()" class="btn btn-success">Login</button> </section>'),a.put("views/teste.html",'<section ng-controller="TesteCtrl" class="boards-page"> <ul class="boards"> <li class="board" ng-repeat="board in boards"> <a ng-href="/teste" class="title">{{ board.name }}</a> </li> </ul> </section>'),a.put("views/topbar.html",'<header class="flex-row container header"> <h1 class="title">{{ $ctrl.board.name || \'Trello Management\' }}</h1> <span ng-if="$ctrl.user">Welcome, {{ $ctrl.user.fullName }} </span> </header>')}]);